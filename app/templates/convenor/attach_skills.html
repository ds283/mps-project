{% import "bootstrap/wtf.html" as wtf %}

{% extends "security/index.html" %}

{% block title %}
    {{ title }}
{% endblock %}

{% block formtitle %}
    Edit transferable skills for project <strong>{{ data.name }}</strong>
{% endblock %}

{% block form_content %}
    <div class="panel panel-default">
        <div class="panel-body">
            {% if data and data.skills %}
                <h4>
                {% for skill in data.ordered_skills %}
                    <a class="btn btn-default selection-label"
                       {% if skill.group is not none %}
                            style="{{ skill.group.make_CSS_style() }}"
                       {% endif %}
                       href="{{ url_for('convenor.remove_skill', projectid=data.id, skillid=skill.id, pclass_id=pclass_id, sel_id=sel_id) }}">
                        <i class="fa fa-times"></i>
                        {% if skill.group is not none  %}
                            {{ skill.group.name }}:
                        {% endif %}
                        {{ skill.name }}
                    </a>
                {% endfor %}
                </h4>
            {% else %}
                <p>No skills currently defined</p>
            {% endif %}
        </div>
        <div class="panel-footer">
            <form action="{{ url_for('convenor.attach_skills', id=data.id, pclass_id=pclass_id) }}" method="POST" name="skill-selector-form">
                {{ form.hidden_tag() }}
                <div class="row vertical-top">
                    <div class="col-xs-10">
                        <div class="form-group {% if form.selector.errors %} has-error{% endif -%}
                                                   {%- if form.selector.flags.required %} required{% endif -%}">
                            {{ form.selector(class="form-control")|safe }}
                            {% if form.selector.errors %}
                                {% for error in form.selector.errors %}
                                    <p class="help-block">{{ error }}</p>
                                {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-xs-2">
                        <div class="pull-right">
                            {{ wtf.form_field(form.submit, button_map={'submit': 'default' }) }}
                        </div>
                    </div>
                </div>
            </form>
            {% if data and skills %}
                <h4>
                    {% for skill in skills %}
                        {% if skill not in data.skills %}
                            <a class="btn btn-default selection-label"
                               href="{{ url_for('convenor.add_skill', projectid=data.id, skillid=skill.id, pclass_id=pclass_id, sel_id=sel_id) }}">
                                <i class="fa fa-plus"></i> {{ skill.name }}
                            </a>
                        {% endif %}
                    {% endfor %}
                </h4>
            {% else %}
                <p>No skills currently defined</p>
            {% endif %}
        </div>
    </div>

    <a href="{{ url_for('convenor.attached', id=pclass_id) }}">
        <i class="fa fa-backward"></i> Return to convenor dashboard
    </a>
{% endblock %}
