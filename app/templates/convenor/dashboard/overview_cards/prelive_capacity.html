{% macro prelive_capacity(data, sel_count) %}
    {% set group_data, total_projects, total_faculty, total_capacity, total_capacity_bounded = data %}
    <div class="well">
        <div class="row vertical-align capacity-table">
            <div class="col-xs-5"><strong>Research group</strong></div>
            <div class="col-xs-2"><strong>Projects</strong></div>
            <div class="col-xs-2"><strong>Capacity</strong></div>
            <div class="col-xs-3"><strong>Unique faculty</strong></div>
        </div>
        <hr class="intro-divider">
        {% for group in group_data %}
            {% set label, proj_count, fac_count, enrolled, total, capacity, bounded = group %}
            <div class="row vertical-align capacity-table">
                <div class="col-xs-5">{{ label|safe }}</div>
                <div class="col-xs-2">
                    {% if proj_count > 0 %}
                        <strong>{{ proj_count }}</strong>
                    {% else %}
                        {{ proj_count }}
                    {% endif %}
                </div>
                <div class="col-xs-2">
                    {% if capacity > 0 %}
                        {% if not bounded %}>= {% endif %}<strong>{{ capacity }}</strong>
                    {% else %}
                        {% if not bounded %}>= {% endif %}0
                    {% endif %}
                </div>
                <div class="col-xs-3">
                    <strong>{{ fac_count }}</strong>
                    <span class="label label-info">{{ enrolled }} enrolled</span>
                    <span class="label label-info">{{ total }} total</span>
                </div>
            </div>
        {% endfor %}
        <hr class="into-divider">
        <div class="row vertical-align capacity-table">
            <div class="col-xs-5"><strong>Total</strong></div>
            <div class="col-xs-2"><strong>{{ total_projects }}</strong></div>
            <div class="col-xs-2">{% if not total_capacity_bounded %}>= {% endif %}<strong>{{ total_capacity }}</strong></div>
        </div>
        <hr class="intro-divider">
        {% if total_capacity < sel_count %}
            <div class="alert alert-block">
                <strong>Warning.</strong>
                There are fewer project places than selectors. More projects are required.
            </div>
        {% elif total_capacity < 1.15*sel_count %}
            <div class="alert alert-warning">
                <strong>Warning.</strong>
                Total capacity is no more than 15% above number of selectors.
                The project allocation is likely to be inflexible.
                Consider adding more projects.
            </div>
        {% endif %}
        {% if total_capacity >= sel_count %}
            {% if total_faculty >= sel_count %}
                <div class="alert alert-info">
                    Approximate allocation is less than one project per faculty member.
                    <p>
                        <strong>Warning.</strong> This estimate does not account for constraints.
                    </p>
                </div>
            {% else %}
                {% set alloc = sel_count / total_faculty %}
                {% set alloc_lo = alloc|round(1, 'floor') %}
                {% set alloc_hi = alloc|round(1, 'ceil') %}
                <div class="alert alert-info">
                    Approximate allocation is between {{ alloc_lo }} and {{ alloc_hi }}
                    projects per faculty member.
                    <p>
                        <strong>Warning.</strong> This estimate does not account for constraints.
                    </p>
                </div>
            {% endif %}
        {% endif %}

    </div>
{% endmacro %}
