{% macro selection_open(config) %}
    <div class="panel panel-success">
        <div class="panel-heading"><strong>Student choices are currently live</strong></div>
        <div class="panel-body">
            <div class="row vertical-top">
                <div class="col-xs-8">
                    {% set submitted, bookmarks, missing, total = config.count_submitted_students %}
                    <div class="row vertical-top">
                        <div class="col-xs-4"><strong>Submitted</strong></div>
                        <div class="col-xs-4"><strong>Has bookmarks</strong></div>
                        <div class="col-xs-4"><strong>No bookmarks</strong></div>
                    </div>
                    <div class="row vertical-top">
                        <div class="col-xs-4">
                            <strong>{{ submitted }}</strong>/{{ total }}
                            <a class="btn btn-link"
                                href="{{ url_for('convenor.selectors', id=config.id, state_filter='submitted') }}">
                                Show ...
                            </a>
                        </div>
                        <div class="col-xs-4">
                            <strong>{{ bookmarks }}</strong>/{{ total }}
                            <a class="btn btn-link"
                                href="{{ url_for('convenor.selectors', id=config.id, state_filter='bookmarks') }}">
                                Show ...
                            </a>
                        </div>
                        <div class="col-xs-4">
                            <strong>{{ missing }}</strong>/{{ total }}
                            <a class="btn btn-link"
                                href="{{ url_for('convenor.selectors', id=config.id, state_filter='none') }}">
                                Show ...
                            </a>
                        </div>
                    </div>
                    <hr class="intro-divider">
                    <div class="row vertical-top">
                        <div class="col-xs-12">
                            {% if submitted == total %}
                                <p>All students have submitted validated choices.</p>
                                <p>It is safe to close selections.</p>
                                <span class="label label-success"><i class="fa fa-check"></i> Ready to proceed</span>
                            {% elif missing == 0 %}
                                <p>
                                    Some students have not yet submitted a validated selection, but all students
                                    have bookmark data.
                                </p>
                                <p>
                                    If selections are closed now, bookmark data will be used when performing
                                    automatic matching for students who are missing a validated selection.
                                </p>
                                <span class="label label-warning"><i class="fa fa-exclamation-triangle"></i> Proceed with caution</span>
                            {% else %}
                                <p>Some students are missing both a validated selection and bookmark data.</p>
                                <p>
                                    If selections are closed now, these students will be allocated an arbitrary project
                                    during automated matching.
                                </p>
                                <span class="label label-warning"><i class="fa fa-exclamation-triangle"></i> Proceed with caution</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="col-xs-4">
                    <div class="pull-right">
                        <a href="{{ url_for('convenor.close_selections', id=config.id) }}"
                           class="btn btn-success grouped-button-margin">
                            Close selections
                        </a>
                        <a href="{{ url_for('convenor.reset_popularity_data', id=config.id) }}"
                           class="btn btn-warning grouped-button-margin">
                            Reset popularity data
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endmacro %}
