{% import "bootstrap/wtf.html" as wtf %}
{% from "macros.html" import date_field %}

{% from "convenor/dashboard/overview_cards/prelive_capacity.html" import prelive_capacity %}

{% macro waiting_confirmations(pclass, config, issue_form, capacity_data, sel_count) %}
    <div class="panel panel-default">
        <div class="panel-heading"><strong>Student choices are not yet live</strong></div>
        <div class="panel-body">

            <div class="row vertical-top">
                <div class="col-xs-9">
                    Confirmations are still outstanding from
                    <strong>{{ config.golive_required.count() }} faculty</strong>.
                </div>
                <div class="col-xs-3">
                    <div class="pull-right">
                        <a href="{{ url_for('convenor.force_confirm_all', id=pclass.id) }}"
                           class="btn btn-danger">
                            Force confirm all
                        </a>
                    </div>
                </div>
            </div>
            <form action="{{ url_for('convenor.issue_confirm_requests', id=pclass.id) }}"
                  method="POST" name="issue-form">
                <div class="row vertical-align">
                    <div class="col-xs-9">
                        {{ date_field(issue_form.request_deadline) }}
                    </div>
                    <div class="col-xs-3">
                        <div class="pull-right">
                            {{ wtf.form_field(issue_form.requests_issued, button_map={'requests_issued': 'primary'}) }}
                        </div>
                    </div>
                </div>
            </form>

            {# display list of faculty with outstanding confirm requests #}
            {% if config.golive_required.first() %}
                <table id="golive-table" class="table table-striped table-bordered">
                    <thead>
                    <tr>
                        <th width="40%"> Name</th>
                        <th width="20%"> Email</th>
                        <th width="40%"> Projects</th>
                    </tr>
                    </thead>
                </table>
            {% endif %}
        </div>
    </div>
    <hr class="intro-divider">
    {{ prelive_capacity(capacity_data, sel_count) }}
{% endmacro %}
