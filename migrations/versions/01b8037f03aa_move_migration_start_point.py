"""move migration start point

Revision ID: 01b8037f03aa
Revises: 
Create Date: 2018-05-15 22:40:23.422188

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '01b8037f03aa'
down_revision = None
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('degree_types',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_degree_types_name'), 'degree_types', ['name'], unique=True)
    op.create_table('main_config',
    sa.Column('year', sa.Integer(), nullable=False),
    sa.PrimaryKeyConstraint('year')
    )
    op.create_table('research_groups',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('abbreviation', sa.String(length=255), nullable=True),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_research_groups_abbreviation'), 'research_groups', ['abbreviation'], unique=True)
    op.create_table('roles',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('description', sa.String(length=255), nullable=True),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('name')
    )
    op.create_table('supervision_team',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('name')
    )
    op.create_table('transferable_skills',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_transferable_skills_name'), 'transferable_skills', ['name'], unique=True)
    op.create_table('users',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('email', sa.String(length=255), nullable=True),
    sa.Column('username', sa.String(length=255), nullable=True),
    sa.Column('password', sa.String(length=255), nullable=True),
    sa.Column('first_name', sa.String(length=255), nullable=True),
    sa.Column('last_name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('confirmed_at', sa.DateTime(), nullable=True),
    sa.Column('last_login_at', sa.DateTime(), nullable=True),
    sa.Column('current_login_at', sa.DateTime(), nullable=True),
    sa.Column('last_login_ip', sa.String(length=60), nullable=True),
    sa.Column('current_login_ip', sa.String(length=60), nullable=True),
    sa.Column('login_count', sa.Integer(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_users_email'), 'users', ['email'], unique=True)
    op.create_index(op.f('ix_users_first_name'), 'users', ['first_name'], unique=False)
    op.create_index(op.f('ix_users_last_name'), 'users', ['last_name'], unique=False)
    op.create_index(op.f('ix_users_username'), 'users', ['username'], unique=True)
    op.create_table('degree_programmes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('type_id', sa.Integer(), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.ForeignKeyConstraint(['type_id'], ['degree_types.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_degree_programmes_name'), 'degree_programmes', ['name'], unique=False)
    op.create_index(op.f('ix_degree_programmes_type_id'), 'degree_programmes', ['type_id'], unique=False)
    op.create_table('faculty_data',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('sign_off_students', sa.Boolean(), nullable=True),
    sa.ForeignKeyConstraint(['id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('project_classes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('abbreviation', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('year', sa.Integer(), nullable=True),
    sa.Column('submissions', sa.Integer(), nullable=True),
    sa.Column('convenor_id', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['convenor_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_project_classes_abbreviation'), 'project_classes', ['abbreviation'], unique=True)
    op.create_index(op.f('ix_project_classes_convenor_id'), 'project_classes', ['convenor_id'], unique=False)
    op.create_index(op.f('ix_project_classes_name'), 'project_classes', ['name'], unique=True)
    op.create_index(op.f('ix_project_classes_year'), 'project_classes', ['year'], unique=False)
    op.create_table('projects',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('keywords', sa.String(length=255), nullable=True),
    sa.Column('owner_id', sa.Integer(), nullable=True),
    sa.Column('group_id', sa.Integer(), nullable=True),
    sa.Column('meeting_reqd', sa.Integer(), nullable=True),
    sa.Column('description', sa.String(length=8000), nullable=True),
    sa.Column('reading', sa.String(length=8000), nullable=True),
    sa.ForeignKeyConstraint(['group_id'], ['research_groups.id'], ),
    sa.ForeignKeyConstraint(['owner_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_projects_group_id'), 'projects', ['group_id'], unique=False)
    op.create_index(op.f('ix_projects_name'), 'projects', ['name'], unique=True)
    op.create_index(op.f('ix_projects_owner_id'), 'projects', ['owner_id'], unique=False)
    op.create_table('roles_users',
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('role_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['role_id'], ['roles.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('user_id', 'role_id')
    )
    op.create_table('faculty_affiliations',
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('group_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['group_id'], ['research_groups.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['faculty_data.id'], ),
    sa.PrimaryKeyConstraint('user_id', 'group_id')
    )
    op.create_table('project_class_to_programmes',
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.Column('programme_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.PrimaryKeyConstraint('project_class_id', 'programme_id')
    )
    op.create_table('project_to_classes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'project_class_id')
    )
    op.create_table('project_to_programmes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('programme_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'programme_id')
    )
    op.create_table('project_to_skills',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('skill_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.ForeignKeyConstraint(['skill_id'], ['transferable_skills.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'skill_id')
    )
    op.create_table('project_to_supervision',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('supervisor.id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.ForeignKeyConstraint(['supervisor.id'], ['supervision_team.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'supervisor.id')
    )
    op.create_table('student_data',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('exam_number', sa.Integer(), nullable=True),
    sa.Column('cohort', sa.Integer(), nullable=True),
    sa.Column('programme_id', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_student_data_cohort'), 'student_data', ['cohort'], unique=True)
    op.create_index(op.f('ix_student_data_exam_number'), 'student_data', ['exam_number'], unique=True)
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index(op.f('ix_student_data_exam_number'), table_name='student_data')
    op.drop_index(op.f('ix_student_data_cohort'), table_name='student_data')
    op.drop_table('student_data')
    op.drop_table('project_to_supervision')
    op.drop_table('project_to_skills')
    op.drop_table('project_to_programmes')
    op.drop_table('project_to_classes')
    op.drop_table('project_class_to_programmes')
    op.drop_table('faculty_affiliations')
    op.drop_table('roles_users')
    op.drop_index(op.f('ix_projects_owner_id'), table_name='projects')
    op.drop_index(op.f('ix_projects_name'), table_name='projects')
    op.drop_index(op.f('ix_projects_group_id'), table_name='projects')
    op.drop_table('projects')
    op.drop_index(op.f('ix_project_classes_year'), table_name='project_classes')
    op.drop_index(op.f('ix_project_classes_name'), table_name='project_classes')
    op.drop_index(op.f('ix_project_classes_convenor_id'), table_name='project_classes')
    op.drop_index(op.f('ix_project_classes_abbreviation'), table_name='project_classes')
    op.drop_table('project_classes')
    op.drop_table('faculty_data')
    op.drop_index(op.f('ix_degree_programmes_type_id'), table_name='degree_programmes')
    op.drop_index(op.f('ix_degree_programmes_name'), table_name='degree_programmes')
    op.drop_table('degree_programmes')
    op.drop_index(op.f('ix_users_username'), table_name='users')
    op.drop_index(op.f('ix_users_last_name'), table_name='users')
    op.drop_index(op.f('ix_users_first_name'), table_name='users')
    op.drop_index(op.f('ix_users_email'), table_name='users')
    op.drop_table('users')
    op.drop_index(op.f('ix_transferable_skills_name'), table_name='transferable_skills')
    op.drop_table('transferable_skills')
    op.drop_table('supervision_team')
    op.drop_table('roles')
    op.drop_index(op.f('ix_research_groups_abbreviation'), table_name='research_groups')
    op.drop_table('research_groups')
    op.drop_table('main_config')
    op.drop_index(op.f('ix_degree_types_name'), table_name='degree_types')
    op.drop_table('degree_types')
    # ### end Alembic commands ###
