"""add tables to support project infrastructure

Revision ID: 256a1e7bcd5d
Revises: 14427c6c1ea8
Create Date: 2018-05-15 10:10:13.200973

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '256a1e7bcd5d'
down_revision = '14427c6c1ea8'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('supervision_team',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('name')
    )
    op.create_table('project_classes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('year', sa.Integer(), nullable=True),
    sa.Column('submissions', sa.Integer(), nullable=True),
    sa.Column('convenor_id', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['convenor_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('name')
    )
    op.create_table('projects',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('owner_id', sa.Integer(), nullable=True),
    sa.Column('group_id', sa.Integer(), nullable=True),
    sa.Column('meeting_reqd', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['group_id'], ['research_groups.id'], ),
    sa.ForeignKeyConstraint(['owner_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('name')
    )
    op.create_table('project_class_to_programmes',
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.Column('programme_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.PrimaryKeyConstraint('project_class_id', 'programme_id')
    )
    op.create_table('project_to_classes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'project_class_id')
    )
    op.create_table('project_to_programmes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('programme_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'programme_id')
    )
    op.create_table('project_to_skills',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('skill_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.ForeignKeyConstraint(['skill_id'], ['transferable_skills.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'skill_id')
    )
    op.create_table('project_to_supervision',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('supervisor.id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.ForeignKeyConstraint(['supervisor.id'], ['supervision_team.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'supervisor.id')
    )
    op.add_column('faculty_data', sa.Column('sign_off_students', sa.Boolean(), nullable=True))
    op.add_column('transferable_skills', sa.Column('active', sa.Boolean(), nullable=True))
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column('transferable_skills', 'active')
    op.drop_column('faculty_data', 'sign_off_students')
    op.drop_table('project_to_supervision')
    op.drop_table('project_to_skills')
    op.drop_table('project_to_programmes')
    op.drop_table('project_to_classes')
    op.drop_table('project_class_to_programmes')
    op.drop_table('projects')
    op.drop_table('project_classes')
    op.drop_table('supervision_team')
    # ### end Alembic commands ###
