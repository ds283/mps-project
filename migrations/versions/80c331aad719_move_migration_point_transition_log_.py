"""Move migration point: transition log fields from String to Text

Revision ID: 80c331aad719
Revises: 
Create Date: 2018-06-09 20:53:41.792266

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '80c331aad719'
down_revision = None
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('backup_config',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('keep_hourly', sa.Integer(), nullable=True),
    sa.Column('keep_daily', sa.Integer(), nullable=True),
    sa.Column('limit', sa.Integer(), nullable=True),
    sa.Column('units', sa.Integer(), nullable=False),
    sa.Column('last_changed', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('celery_crontabs',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('minute', sa.String(length=64), nullable=True),
    sa.Column('hour', sa.String(length=64), nullable=True),
    sa.Column('day_of_week', sa.String(length=64), nullable=True),
    sa.Column('day_of_month', sa.String(length=64), nullable=True),
    sa.Column('month_of_year', sa.String(length=64), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('celery_intervals',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('every', sa.Integer(), nullable=False),
    sa.Column('period', sa.String(length=24), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('main_config',
    sa.Column('year', sa.Integer(), nullable=False),
    sa.PrimaryKeyConstraint('year')
    )
    op.create_table('roles',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('description', sa.String(length=255), nullable=True),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('name')
    )
    op.create_table('users',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('email', sa.String(length=255), nullable=True),
    sa.Column('username', sa.String(length=255), nullable=True),
    sa.Column('password', sa.String(length=255), nullable=True),
    sa.Column('first_name', sa.String(length=255), nullable=True),
    sa.Column('last_name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('confirmed_at', sa.DateTime(), nullable=True),
    sa.Column('last_login_at', sa.DateTime(), nullable=True),
    sa.Column('current_login_at', sa.DateTime(), nullable=True),
    sa.Column('last_login_ip', sa.String(length=60), nullable=True),
    sa.Column('current_login_ip', sa.String(length=60), nullable=True),
    sa.Column('login_count', sa.Integer(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_users_email'), 'users', ['email'], unique=True)
    op.create_index(op.f('ix_users_first_name'), 'users', ['first_name'], unique=False)
    op.create_index(op.f('ix_users_last_name'), 'users', ['last_name'], unique=False)
    op.create_index(op.f('ix_users_username'), 'users', ['username'], unique=True)
    op.create_table('backups',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('owner_id', sa.Integer(), nullable=True),
    sa.Column('description', sa.String(length=255), nullable=True),
    sa.Column('date', sa.DateTime(), nullable=True),
    sa.Column('type', sa.Integer(), nullable=True),
    sa.Column('filename', sa.String(length=255), nullable=True),
    sa.Column('db_size', sa.Integer(), nullable=True),
    sa.Column('archive_size', sa.Integer(), nullable=True),
    sa.Column('backup_size', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['owner_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_backups_date'), 'backups', ['date'], unique=False)
    op.create_table('celery_schedules',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('task', sa.String(length=255), nullable=True),
    sa.Column('interval_id', sa.Integer(), nullable=True),
    sa.Column('crontab_id', sa.Integer(), nullable=True),
    sa.Column('arguments', sa.String(length=255), nullable=True),
    sa.Column('keyword_arguments', sa.String(length=255), nullable=True),
    sa.Column('queue', sa.String(length=255), nullable=True),
    sa.Column('exchange', sa.String(length=255), nullable=True),
    sa.Column('routing_key', sa.String(length=255), nullable=True),
    sa.Column('expires', sa.DateTime(), nullable=True),
    sa.Column('enabled', sa.Boolean(), nullable=True),
    sa.Column('last_run_at', sa.DateTime(), nullable=True),
    sa.Column('total_run_count', sa.Integer(), nullable=True),
    sa.Column('date_changed', sa.DateTime(), nullable=True),
    sa.Column('owner_id', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['crontab_id'], ['celery_crontabs.id'], ),
    sa.ForeignKeyConstraint(['interval_id'], ['celery_intervals.id'], ),
    sa.ForeignKeyConstraint(['owner_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('degree_types',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_degree_types_name'), 'degree_types', ['name'], unique=True)
    op.create_table('email_log',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('recipient', sa.String(length=255), nullable=True),
    sa.Column('send_date', sa.DateTime(), nullable=True),
    sa.Column('subject', sa.String(length=255), nullable=True),
    sa.Column('body', sa.Text(), nullable=True),
    sa.Column('html', sa.Text(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_email_log_send_date'), 'email_log', ['send_date'], unique=False)
    op.create_table('faculty_data',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('academic_title', sa.Integer(), nullable=True),
    sa.Column('use_academic_title', sa.Boolean(), nullable=True),
    sa.Column('sign_off_students', sa.Boolean(), nullable=True),
    sa.Column('office', sa.String(length=255), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('messages',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('issue_date', sa.DateTime(), nullable=True),
    sa.Column('show_students', sa.Boolean(), nullable=True),
    sa.Column('show_faculty', sa.Boolean(), nullable=True),
    sa.Column('show_login', sa.Boolean(), nullable=True),
    sa.Column('dismissible', sa.Boolean(), nullable=True),
    sa.Column('title', sa.String(length=255), nullable=True),
    sa.Column('body', sa.Text(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_messages_issue_date'), 'messages', ['issue_date'], unique=False)
    op.create_table('notifications',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('type', sa.Integer(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('uuid', sa.String(length=255), nullable=True),
    sa.Column('timestamp', sa.Integer(), nullable=True),
    sa.Column('remove_on_pageload', sa.Boolean(), nullable=True),
    sa.Column('payload_json', sa.Text(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_notifications_timestamp'), 'notifications', ['timestamp'], unique=False)
    op.create_index(op.f('ix_notifications_uuid'), 'notifications', ['uuid'], unique=False)
    op.create_table('project_classes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('abbreviation', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('year', sa.Integer(), nullable=True),
    sa.Column('extent', sa.Integer(), nullable=True),
    sa.Column('require_confirm', sa.Boolean(), nullable=True),
    sa.Column('supervisor_carryover', sa.Boolean(), nullable=True),
    sa.Column('submissions', sa.Integer(), nullable=True),
    sa.Column('initial_choices', sa.Integer(), nullable=True),
    sa.Column('switch_choices', sa.Integer(), nullable=True),
    sa.Column('selection_open_to_all', sa.Boolean(), nullable=True),
    sa.Column('convenor_id', sa.Integer(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['convenor_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_project_classes_abbreviation'), 'project_classes', ['abbreviation'], unique=True)
    op.create_index(op.f('ix_project_classes_convenor_id'), 'project_classes', ['convenor_id'], unique=False)
    op.create_index(op.f('ix_project_classes_name'), 'project_classes', ['name'], unique=True)
    op.create_index(op.f('ix_project_classes_year'), 'project_classes', ['year'], unique=False)
    op.create_table('research_groups',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('abbreviation', sa.String(length=255), nullable=True),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('website', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_research_groups_abbreviation'), 'research_groups', ['abbreviation'], unique=True)
    op.create_table('roles_users',
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('role_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['role_id'], ['roles.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('user_id', 'role_id')
    )
    op.create_table('supervision_team',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('name')
    )
    op.create_table('tasks',
    sa.Column('id', sa.String(length=255), nullable=False),
    sa.Column('owner_id', sa.Integer(), nullable=True),
    sa.Column('start_date', sa.DateTime(), nullable=True),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('description', sa.String(length=255), nullable=True),
    sa.Column('status', sa.Integer(), nullable=True),
    sa.Column('progress', sa.Integer(), nullable=True),
    sa.Column('message', sa.String(length=255), nullable=True),
    sa.ForeignKeyConstraint(['owner_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_tasks_name'), 'tasks', ['name'], unique=False)
    op.create_table('transferable_skills',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_transferable_skills_name'), 'transferable_skills', ['name'], unique=True)
    op.create_table('degree_programmes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('type_id', sa.Integer(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['type_id'], ['degree_types.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_degree_programmes_name'), 'degree_programmes', ['name'], unique=False)
    op.create_index(op.f('ix_degree_programmes_type_id'), 'degree_programmes', ['type_id'], unique=False)
    op.create_table('faculty_affiliations',
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('group_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['group_id'], ['research_groups.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['faculty_data.id'], ),
    sa.PrimaryKeyConstraint('user_id', 'group_id')
    )
    op.create_table('faculty_enrollments',
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['faculty_data.id'], ),
    sa.PrimaryKeyConstraint('user_id', 'project_class_id')
    )
    op.create_table('message_dismissals',
    sa.Column('message_id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['message_id'], ['messages.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('message_id', 'user_id')
    )
    op.create_table('project_class_config',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('year', sa.Integer(), nullable=True),
    sa.Column('pclass_id', sa.Integer(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('requests_issued', sa.Boolean(), nullable=True),
    sa.Column('request_deadline', sa.DateTime(), nullable=True),
    sa.Column('live', sa.Boolean(), nullable=True),
    sa.Column('golive_id', sa.Integer(), nullable=True),
    sa.Column('golive_timestamp', sa.DateTime(), nullable=True),
    sa.Column('live_deadline', sa.DateTime(), nullable=True),
    sa.Column('closed', sa.Boolean(), nullable=True),
    sa.Column('closed_id', sa.Integer(), nullable=True),
    sa.Column('closed_timestamp', sa.DateTime(), nullable=True),
    sa.Column('submission_period', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['closed_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['golive_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['pclass_id'], ['project_classes.id'], ),
    sa.ForeignKeyConstraint(['year'], ['main_config.year'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('project_class_to_messages',
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.Column('message_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['message_id'], ['messages.id'], ),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.PrimaryKeyConstraint('project_class_id', 'message_id')
    )
    op.create_table('projects',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('active', sa.Boolean(), nullable=True),
    sa.Column('keywords', sa.String(length=255), nullable=True),
    sa.Column('owner_id', sa.Integer(), nullable=True),
    sa.Column('group_id', sa.Integer(), nullable=True),
    sa.Column('meeting_reqd', sa.Integer(), nullable=True),
    sa.Column('capacity', sa.Integer(), nullable=True),
    sa.Column('enforce_capacity', sa.Boolean(), nullable=True),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('reading', sa.Text(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['group_id'], ['research_groups.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['owner_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_projects_group_id'), 'projects', ['group_id'], unique=False)
    op.create_index(op.f('ix_projects_name'), 'projects', ['name'], unique=True)
    op.create_index(op.f('ix_projects_owner_id'), 'projects', ['owner_id'], unique=False)
    op.create_table('go_live_confirmation',
    sa.Column('faculty_id', sa.Integer(), nullable=False),
    sa.Column('pclass_config_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['faculty_id'], ['faculty_data.id'], ),
    sa.ForeignKeyConstraint(['pclass_config_id'], ['project_class_config.id'], ),
    sa.PrimaryKeyConstraint('faculty_id', 'pclass_config_id')
    )
    op.create_table('live_projects',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('config_id', sa.Integer(), nullable=True),
    sa.Column('number', sa.Integer(), nullable=True),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('keywords', sa.String(length=255), nullable=True),
    sa.Column('owner_id', sa.Integer(), nullable=True),
    sa.Column('group_id', sa.Integer(), nullable=True),
    sa.Column('capacity', sa.Integer(), nullable=True),
    sa.Column('enforce_capacity', sa.Boolean(), nullable=True),
    sa.Column('meeting_reqd', sa.Integer(), nullable=True),
    sa.Column('description', sa.Text(), nullable=True),
    sa.Column('reading', sa.Text(), nullable=True),
    sa.Column('page_views', sa.Integer(), nullable=True),
    sa.Column('last_view', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['config_id'], ['project_class_config.id'], ),
    sa.ForeignKeyConstraint(['group_id'], ['research_groups.id'], ),
    sa.ForeignKeyConstraint(['owner_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_live_projects_group_id'), 'live_projects', ['group_id'], unique=False)
    op.create_index(op.f('ix_live_projects_name'), 'live_projects', ['name'], unique=False)
    op.create_index(op.f('ix_live_projects_owner_id'), 'live_projects', ['owner_id'], unique=False)
    op.create_table('project_class_to_programmes',
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.Column('programme_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.PrimaryKeyConstraint('project_class_id', 'programme_id')
    )
    op.create_table('project_to_classes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'project_class_id')
    )
    op.create_table('project_to_programmes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('programme_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'programme_id')
    )
    op.create_table('project_to_skills',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('skill_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.ForeignKeyConstraint(['skill_id'], ['transferable_skills.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'skill_id')
    )
    op.create_table('project_to_supervision',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('supervisor.id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['projects.id'], ),
    sa.ForeignKeyConstraint(['supervisor.id'], ['supervision_team.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'supervisor.id')
    )
    op.create_table('selecting_students',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('retired', sa.Integer(), nullable=True),
    sa.Column('config_id', sa.Integer(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['config_id'], ['project_class_config.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('student_data',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('exam_number', sa.Integer(), nullable=True),
    sa.Column('cohort', sa.Integer(), nullable=True),
    sa.Column('programme_id', sa.Integer(), nullable=True),
    sa.Column('creator_id', sa.Integer(), nullable=True),
    sa.Column('creation_timestamp', sa.DateTime(), nullable=True),
    sa.Column('last_edit_id', sa.Integer(), nullable=True),
    sa.Column('last_edit_timestamp', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['creator_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['last_edit_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_student_data_cohort'), 'student_data', ['cohort'], unique=False)
    op.create_index(op.f('ix_student_data_exam_number'), 'student_data', ['exam_number'], unique=True)
    op.create_table('submitting_students',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('retired', sa.Integer(), nullable=True),
    sa.Column('config_id', sa.Integer(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['config_id'], ['project_class_config.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('bookmarks',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('liveproject_id', sa.Integer(), nullable=True),
    sa.Column('rank', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['liveproject_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['selecting_students.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('confirmation_requests',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('student_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['student_id'], ['selecting_students.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'student_id')
    )
    op.create_table('faculty_confirmations',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('student_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['student_id'], ['selecting_students.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'student_id')
    )
    op.create_table('live_project_to_classes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'project_class_id')
    )
    op.create_table('live_project_to_programmes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('programme_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'programme_id')
    )
    op.create_table('live_project_to_skills',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('skill_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['skill_id'], ['transferable_skills.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'skill_id')
    )
    op.create_table('live_project_to_supervision',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('supervisor.id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['supervisor.id'], ['supervision_team.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'supervisor.id')
    )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('live_project_to_supervision')
    op.drop_table('live_project_to_skills')
    op.drop_table('live_project_to_programmes')
    op.drop_table('live_project_to_classes')
    op.drop_table('faculty_confirmations')
    op.drop_table('confirmation_requests')
    op.drop_table('bookmarks')
    op.drop_table('submitting_students')
    op.drop_index(op.f('ix_student_data_exam_number'), table_name='student_data')
    op.drop_index(op.f('ix_student_data_cohort'), table_name='student_data')
    op.drop_table('student_data')
    op.drop_table('selecting_students')
    op.drop_table('project_to_supervision')
    op.drop_table('project_to_skills')
    op.drop_table('project_to_programmes')
    op.drop_table('project_to_classes')
    op.drop_table('project_class_to_programmes')
    op.drop_index(op.f('ix_live_projects_owner_id'), table_name='live_projects')
    op.drop_index(op.f('ix_live_projects_name'), table_name='live_projects')
    op.drop_index(op.f('ix_live_projects_group_id'), table_name='live_projects')
    op.drop_table('live_projects')
    op.drop_table('go_live_confirmation')
    op.drop_index(op.f('ix_projects_owner_id'), table_name='projects')
    op.drop_index(op.f('ix_projects_name'), table_name='projects')
    op.drop_index(op.f('ix_projects_group_id'), table_name='projects')
    op.drop_table('projects')
    op.drop_table('project_class_to_messages')
    op.drop_table('project_class_config')
    op.drop_table('message_dismissals')
    op.drop_table('faculty_enrollments')
    op.drop_table('faculty_affiliations')
    op.drop_index(op.f('ix_degree_programmes_type_id'), table_name='degree_programmes')
    op.drop_index(op.f('ix_degree_programmes_name'), table_name='degree_programmes')
    op.drop_table('degree_programmes')
    op.drop_index(op.f('ix_transferable_skills_name'), table_name='transferable_skills')
    op.drop_table('transferable_skills')
    op.drop_index(op.f('ix_tasks_name'), table_name='tasks')
    op.drop_table('tasks')
    op.drop_table('supervision_team')
    op.drop_table('roles_users')
    op.drop_index(op.f('ix_research_groups_abbreviation'), table_name='research_groups')
    op.drop_table('research_groups')
    op.drop_index(op.f('ix_project_classes_year'), table_name='project_classes')
    op.drop_index(op.f('ix_project_classes_name'), table_name='project_classes')
    op.drop_index(op.f('ix_project_classes_convenor_id'), table_name='project_classes')
    op.drop_index(op.f('ix_project_classes_abbreviation'), table_name='project_classes')
    op.drop_table('project_classes')
    op.drop_index(op.f('ix_notifications_uuid'), table_name='notifications')
    op.drop_index(op.f('ix_notifications_timestamp'), table_name='notifications')
    op.drop_table('notifications')
    op.drop_index(op.f('ix_messages_issue_date'), table_name='messages')
    op.drop_table('messages')
    op.drop_table('faculty_data')
    op.drop_index(op.f('ix_email_log_send_date'), table_name='email_log')
    op.drop_table('email_log')
    op.drop_index(op.f('ix_degree_types_name'), table_name='degree_types')
    op.drop_table('degree_types')
    op.drop_table('celery_schedules')
    op.drop_index(op.f('ix_backups_date'), table_name='backups')
    op.drop_table('backups')
    op.drop_index(op.f('ix_users_username'), table_name='users')
    op.drop_index(op.f('ix_users_last_name'), table_name='users')
    op.drop_index(op.f('ix_users_first_name'), table_name='users')
    op.drop_index(op.f('ix_users_email'), table_name='users')
    op.drop_table('users')
    op.drop_table('roles')
    op.drop_table('main_config')
    op.drop_table('celery_intervals')
    op.drop_table('celery_crontabs')
    op.drop_table('backup_config')
    # ### end Alembic commands ###
