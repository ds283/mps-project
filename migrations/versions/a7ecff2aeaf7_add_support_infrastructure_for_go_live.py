"""add support infrastructure for go-live

Revision ID: a7ecff2aeaf7
Revises: f6bbf7f81969
Create Date: 2018-05-17 14:49:58.269998

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = 'a7ecff2aeaf7'
down_revision = 'f6bbf7f81969'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('project_class_config',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('year', sa.Integer(), nullable=True),
    sa.Column('pclass_id', sa.Integer(), nullable=True),
    sa.Column('live', sa.Boolean(), nullable=True),
    sa.Column('closed', sa.Boolean(), nullable=True),
    sa.ForeignKeyConstraint(['pclass_id'], ['project_classes.id'], ),
    sa.ForeignKeyConstraint(['year'], ['main_config.year'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('live_projects',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('config_id', sa.Integer(), nullable=True),
    sa.Column('number', sa.Integer(), nullable=True),
    sa.Column('name', sa.String(length=255), nullable=True),
    sa.Column('keywords', sa.String(length=255), nullable=True),
    sa.Column('owner_id', sa.Integer(), nullable=True),
    sa.Column('group_id', sa.Integer(), nullable=True),
    sa.Column('meeting_reqd', sa.Integer(), nullable=True),
    sa.Column('description', sa.String(length=8000), nullable=True),
    sa.Column('reading', sa.String(length=8000), nullable=True),
    sa.Column('page_views', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['config_id'], ['project_class_config.id'], ),
    sa.ForeignKeyConstraint(['group_id'], ['research_groups.id'], ),
    sa.ForeignKeyConstraint(['owner_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_live_projects_group_id'), 'live_projects', ['group_id'], unique=False)
    op.create_index(op.f('ix_live_projects_name'), 'live_projects', ['name'], unique=True)
    op.create_index(op.f('ix_live_projects_owner_id'), 'live_projects', ['owner_id'], unique=False)
    op.create_table('live_project_to_classes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('project_class_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_class_id'], ['project_classes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'project_class_id')
    )
    op.create_table('live_project_to_programmes',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('programme_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['programme_id'], ['degree_programmes.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'programme_id')
    )
    op.create_table('live_project_to_skills',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('skill_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['skill_id'], ['transferable_skills.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'skill_id')
    )
    op.create_table('live_project_to_supervision',
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.Column('supervisor.id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['supervisor.id'], ['supervision_team.id'], ),
    sa.PrimaryKeyConstraint('project_id', 'supervisor.id')
    )
    op.create_table('live_students',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('config_id', sa.Integer(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('project_id', sa.Integer(), nullable=True),
    sa.Column('examiner_id', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['config_id'], ['project_class_config.id'], ),
    sa.ForeignKeyConstraint(['examiner_id'], ['faculty_data.id'], ),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('confirmation_requests',
    sa.Column('faculty_id', sa.Integer(), nullable=False),
    sa.Column('student_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['faculty_id'], ['faculty_data.id'], ),
    sa.ForeignKeyConstraint(['student_id'], ['live_students.id'], ),
    sa.PrimaryKeyConstraint('faculty_id', 'student_id')
    )
    op.create_table('faculty_confirmations',
    sa.Column('faculty_id', sa.Integer(), nullable=False),
    sa.Column('student_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['faculty_id'], ['faculty_data.id'], ),
    sa.ForeignKeyConstraint(['student_id'], ['live_students.id'], ),
    sa.PrimaryKeyConstraint('faculty_id', 'student_id')
    )
    op.create_table('project_bookmarks',
    sa.Column('student_id', sa.Integer(), nullable=False),
    sa.Column('project_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['project_id'], ['live_projects.id'], ),
    sa.ForeignKeyConstraint(['student_id'], ['live_students.id'], ),
    sa.PrimaryKeyConstraint('student_id', 'project_id')
    )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('project_bookmarks')
    op.drop_table('faculty_confirmations')
    op.drop_table('confirmation_requests')
    op.drop_table('live_students')
    op.drop_table('live_project_to_supervision')
    op.drop_table('live_project_to_skills')
    op.drop_table('live_project_to_programmes')
    op.drop_table('live_project_to_classes')
    op.drop_index(op.f('ix_live_projects_owner_id'), table_name='live_projects')
    op.drop_index(op.f('ix_live_projects_name'), table_name='live_projects')
    op.drop_index(op.f('ix_live_projects_group_id'), table_name='live_projects')
    op.drop_table('live_projects')
    op.drop_table('project_class_config')
    # ### end Alembic commands ###
